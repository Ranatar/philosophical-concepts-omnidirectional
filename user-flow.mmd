sequenceDiagram
    actor User as Пользователь
    participant UI as Интерфейс
    participant GS as Сервис графов
    participant TS as Сервис тезисов
    participant CS as Сервис Claude
    participant NS as Сервис анализа названий
    participant OS as Сервис определения происхождения
    participant GDB as Графовая БД
    participant DDB as Документная БД
    
    Note over User,DDB: Уровень 1: Работа с графом концепции
    
    User->>UI: Создание категории "Субъективная реальность"
    UI->>GS: Запрос на создание категории
    GS->>GDB: Сохранение категории
    GDB-->>GS: Подтверждение
    
    User->>UI: Создание категории "Интерсубъективность"
    UI->>GS: Запрос на создание категории
    GS->>GDB: Сохранение категории
    GDB-->>GS: Подтверждение
    
    User->>UI: Создание связи "Диалектическая" между категориями
    UI->>GS: Запрос на создание связи
    GS->>GDB: Сохранение связи
    GDB-->>GS: Подтверждение
    
    User->>UI: Запрос обогащения категории "Субъективная реальность"
    UI->>CS: Запрос на обогащение
    CS->>GDB: Получение данных о категории и концепции
    GDB-->>CS: Данные
    CS->>Claude: Запрос к Claude
    Claude-->>CS: Развернутое описание
    CS->>DDB: Сохранение обогащения
    DDB-->>CS: Подтверждение
    CS-->>UI: Результат обогащения
    UI-->>User: Отображение результата
    
    User->>UI: Запрос валидации графа
    UI->>CS: Запрос на валидацию
    CS->>GDB: Получение полного графа концепции
    GDB-->>CS: Данные графа
    CS->>Claude: Запрос к Claude
    Claude-->>CS: Анализ и рекомендации
    CS-->>UI: Результаты валидации
    UI-->>User: Отображение результатов
    
    User->>UI: Внесение корректив в граф
    UI->>GS: Обновление графа
    GS->>GDB: Сохранение изменений
    GDB-->>GS: Подтверждение
    
    Note over User,DDB: Уровень 2: Работа с тезисами концепции и двунаправленные преобразования
    
    User->>UI: Запрос на генерацию онтологических тезисов
    UI->>TS: Запрос с параметрами
    TS->>GDB: Получение данных графа
    GDB-->>TS: Данные
    TS->>CS: Запрос на генерацию тезисов
    CS->>Claude: Запрос к Claude
    Claude-->>CS: Сгенерированные тезисы
    CS->>DDB: Сохранение тезисов
    DDB-->>CS: Подтверждение
    CS-->>TS: Результат
    TS-->>UI: Тезисы
    UI-->>User: Отображение тезисов
    
    User->>UI: Запрос на обоснование тезиса
    UI->>CS: Запрос на обоснование
    CS->>DDB: Получение тезиса
    DDB-->>CS: Данные тезиса
    CS->>Claude: Запрос к Claude
    Claude-->>CS: Обоснование и контраргументы
    CS->>DDB: Сохранение обоснования
    DDB-->>CS: Подтверждение
    CS-->>UI: Результат обоснования
    UI-->>User: Отображение обоснования
    
    Note over User,DDB: Новый поток: Генерация графа из тезисов
    
    User->>UI: Запрос на генерацию графа из тезисов
    UI->>GS: Запрос с параметрами
    GS->>DDB: Получение данных тезисов
    DDB-->>GS: Данные тезисов
    GS->>CS: Запрос на генерацию графа
    CS->>Claude: Запрос к Claude
    Claude-->>CS: Сгенерированный граф
    CS->>GS: Результат
    GS->>GDB: Сохранение графа
    GDB-->>GS: Подтверждение
    GS-->>UI: Результат
    UI-->>User: Отображение сгенерированного графа
    
    Note over User,DDB: Новый поток: Анализ названия концепции
    
    User->>UI: Запрос на анализ названия концепции
    UI->>NS: Запрос на анализ
    NS->>DDB: Получение данных концепции
    DDB-->>NS: Данные
    NS->>CS: Запрос на анализ названия
    CS->>Claude: Запрос к Claude
    Claude-->>CS: Анализ названия и альтернативы
    CS-->>NS: Результат
    NS->>DDB: Сохранение результатов
    DDB-->>NS: Подтверждение
    NS-->>UI: Результаты анализа
    UI-->>User: Отображение результатов
    
    Note over User,DDB: Новый поток: Определение происхождения
    
    User->>UI: Запрос на определение происхождения концепции
    UI->>OS: Запрос на анализ происхождения
    OS->>DDB: Получение тезисов
    DDB-->>OS: Данные тезисов
    OS->>GDB: Получение графа
    GDB-->>OS: Данные графа
    OS->>CS: Запрос на анализ происхождения
    CS->>Claude: Запрос к Claude
    Claude-->>CS: Анализ происхождения и родительские концепции
    CS-->>OS: Результат
    OS->>DDB: Сохранение результатов
    DDB-->>OS: Подтверждение
    OS-->>UI: Результаты анализа
    UI-->>User: Отображение родительских концепций